<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบโชว์ประวัติการซื้อขาย</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        .logo {
            width: 150px;
            margin-bottom: 20px;
            cursor: pointer;
        }
        .product-list {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .product {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            width: 250px;
            padding: 10px;
            text-align: center;
        }
        .product h3 {
            color: #333;
        }
        .product button {
            background-color: #ff5722;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        .product button:hover {
            background-color: #e64a19;
        }
        .reviews {
            display: none;
            margin-top: 10px;
            text-align: left;
            padding: 10px;
            background-color: #f1f1f1;
            border-radius: 5px;
        }
        .reviews p {
            font-size: 14px;
            margin: 5px 0;
        }
        .stars {
            font-size: 20px;
            color: gold;
        }
        .status {
            color: #333;
            font-size: 16px;
            margin-top: 10px;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
</head>
<body>

    <header>
        <h2>ระบบโชว์ประวัติการซื้อขาย</h2>
    </header>

    <div class="product-list">
        <!-- RoV -->
        <div class="product" id="rov">
            <h3>RoV (Garena คูปอง)</h3>
            <ul>
                <li>50฿ → 51 คูปอง</li>
                <li>90฿ → 96 คูปอง</li>
                <li>150฿ → 160 คูปอง</li>
                <li>300฿ → 325 คูปอง</li>
                <li>1,000฿ → ~1,200 คูปอง (มีโบนัส)</li>
            </ul>
            <button onclick="toggleReviews('rov')">ดูรีวิว</button>
            <div id="reviews-rov" class="reviews">
                <div class="stars">★★★★★</div>
                <p>ลูกค้าที่ยืนยันการสั่งซื้อ 2,793 คน</p>
            </div>
        </div>

        <!-- Minecraft -->
        <div class="product" id="minecraft">
            <h3>Minecraft</h3>
            <ul>
                <li>Java หรือ Bedrock Edition: ~580฿</li>
                <li>Minecoins 1,720: ~296฿</li>
                <li>Minecoins 3,500: ~587฿</li>
            </ul>
            <button onclick="toggleReviews('minecraft')">ดูรีวิว</button>
            <div id="reviews-minecraft" class="reviews">
                <div class="stars">★★★★★</div>
                <p>ลูกค้าที่ยืนยันการสั่งซื้อ 2,793 คน</p>
            </div>
        </div>

        <!-- Roblox -->
        <div class="product" id="roblox">
            <h3>Roblox</h3>
            <ul>
                <li>400 Robux: ~179฿</li>
                <li>800 Robux: ~359฿</li>
                <li>1,700 Robux: ~719฿</li>
                <li>Roblox Premium เริ่มต้นที่ ~179฿/เดือน</li>
            </ul>
            <button onclick="toggleReviews('roblox')">ดูรีวิว</button>
            <div id="reviews-roblox" class="reviews">
                <div class="stars">★★★★★</div>
                <p>ลูกค้าที่ยืนยันการสั่งซื้อ 2,793 คน</p>
            </div>
        </div>

        <!-- TrueMoney Wallet -->
        <div class="product" id="truemoney">
            <h3>TrueMoney Wallet</h3>
            <ul>
                <li>50฿, 100฿, 300฿, 500฿</li>
                <li>มีค่าธรรมเนียมกรณีบางช่องทาง</li>
            </ul>
            <button onclick="toggleReviews('truemoney')">ดูรีวิว</button>
            <div id="reviews-truemoney" class="reviews">
                <div class="stars">★★★★★</div>
                <p>ลูกค้าที่ยืนยันการสั่งซื้อ 2,793 คน</p>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBxO_iCEiXDTdg_90bUkvqv6S4a3Mk9070",
            authDomain: "redzone-topup-852a2.firebaseapp.com",
            projectId: "redzone-topup-852a2",
            storageBucket: "redzone-topup-852a2.firebasestorage.app",
            messagingSenderId: "209606560486",
            appId: "1:209606560486:web:d12baa8545d99adad14927",
            measurementId: "G-T1WWTKDY79"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore(app);

        // ฟังก์ชัน toggle รีวิว
        function toggleReviews(product) {
            const reviewsDiv = document.getElementById(`reviews-${product}`);
            reviewsDiv.style.display = reviewsDiv.style.display === "block" ? "none" : "block";
            // ดึงข้อมูลรีวิวจาก Firebase
            fetchReviews(product);
        }

        // ฟังก์ชันดึงรีวิวจาก Firebase
        function fetchReviews(product) {
            db.collection("reviews").where("product", "==", product).get()
            .then((querySnapshot) => {
                let reviewText = "";
                querySnapshot.forEach((doc) => {
                    reviewText += `ลูกค้า: ${doc.data().refCode}, คะแนน: ${"★".repeat(doc.data().rating)}\n`;
                });
                const reviewsDiv = document.getElementById(`reviews-${product}`);
                reviewsDiv.innerHTML = `<div class="stars">★★★★★</div>
                                        <p>ลูกค้าที่ยืนยันการสั่งซื้อ ${querySnapshot.size} คน</p>
                                        <pre>${reviewText}</pre>`;
            })
            .catch((error) => {
                console.error("Error fetching reviews: ", error);
            });
        }

        // ฟังก์ชันสร้างรีวิวลูกค้าปลอม
        function generateFakeCustomers() {
            const fakeCustomers = [];
            const numCustomers = 2793; // จำนวนลูกค้า
            const ratingRange = [4, 5]; // ให้รีวิวเฉลี่ย 4-5 ดาว

            for (let i = 0; i < numCustomers; i++) {
                const customer = {
                    refCode: `REF-${Math.random().toString(36).substr(2, 6).toUpperCase()}`,
                    product: ["rov", "minecraft", "roblox", "truemoney"][Math.floor(Math.random() * 4)],
                    rating: Math.floor(Math.random() * (ratingRange[1] - ratingRange[0] + 1)) + ratingRange[0],
                    createdAt: new Date(),
                    isFake: true // กำหนดเป็นลูกค้าปลอม
                };
                fakeCustomers.push(customer);
            }

            fakeCustomers.forEach(customer => {
                db.collection("reviews").add(customer)
                .then(() => {
                    console.log(`ลูกค้าปลอม ${customer.refCode} ถูกเพิ่มสำเร็จ`);
                }).catch((error) => {
                    console.error("Error adding customer: ", error);
                });
            });
        }

        // เรียกใช้การสร้างลูกค้าปลอมๆ
        generateFakeCustomers();
    </script>
</body>
</html>